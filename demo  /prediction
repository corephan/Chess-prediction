import numpy as np # Already imported, but good practice for standalone cells

# Assuming 'model' and 'numerical_rep' are available from previous steps
# If not, re-initialize for demonstration purposes
if 'model' not in locals():
    print("Model not found. Please run the model definition cell first.")
    # Re-create a dummy model for this demonstration if necessary
    from tensorflow.keras.models import Sequential
    from tensorflow.keras.layers import Dense
    model = Sequential([
        Dense(128, activation='relu', input_shape=(64,)),
        Dense(64, activation='relu'),
        Dense(3, activation='softmax')
    ])

if 'numerical_rep' not in locals():
    print("Numerical representation not found. Please run the board conversion cell first.")
    # Re-create a dummy numerical_rep if necessary
    initial_board = chess.Board()
    numerical_rep = board_to_numerical_representation(initial_board)

print("\n--- Demonstrating Model Prediction ---")

# The model expects a batch of inputs, so we need to add an extra dimension
input_for_prediction = np.expand_dims(numerical_rep, axis=0)

# Make a prediction
predictions = model.predict(input_for_prediction)

# Print the prediction (probabilities for each outcome)
print("Prediction probabilities (White win, Black win, Draw):")
print(predictions)

# Interpret the prediction
predicted_class = np.argmax(predictions)
outcomes = ["White Win", "Black Win", "Draw"]
print(f"Predicted outcome: {outcomes[predicted_class]} (with probability {predictions[0, predicted_class]:.2f})")
print("------------------------------------")
